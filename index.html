<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Орфографический тренажёр</title>

  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js');
      });
    }
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 20px;
      background: #f5f5f5;
    }
    #app { max-width: 600px; margin: auto; }
    h2 { text-align: center; }
    .card {
      background: #ffffff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    input {
      width: 100%; padding: 10px;
      font-size: 20px;
      margin-top: 10px;
      box-sizing: border-box;
    }
    button {
      width: 100%; padding: 14px;
      font-size: 18px;
      margin-top: 15px;
      border: none;
      background: #2196f3;
      color: #ffffff;
      border-radius: 6px;
      cursor: pointer;
    }
    button:active { transform: scale(0.98); }
    .red { color: red; font-weight: bold; }
    .word { font-size: 22px; margin-bottom: 10px; }
    .result-line {
      margin-bottom: 8px;
      font-size: 18px;
    }
    .small { font-size: 14px; color: #555; }
  </style>
</head>

<body>
<div id="app">

  <h2>Орфографический тренажёр</h2>

  <div id="game" class="card">
    <div class="small">Напишите правильное слово.</div>
    <div id="wrongWord" class="word"></div>
    <input id="userInput" placeholder="Введите правильное слово" autocomplete="off" />
    <button id="okBtn">OK</button>
    <div class="small" id="progress"></div>
  </div>

  <div id="results" class="card" style="display:none;"></div>
  <button id="restartBtn" style="display:none;">Начать тур заново</button>

</div>

<script>
const WORDS = [
  ["автомобиль","афтомобил"],
  ["агроном","аграном"],
  ["адрес","адрис"],
  ["аллея","алея"],
  ["аппетит","апетит"],

  ["багаж","багаш"],
  ["беседа","биседа"],
  ["беседовать","биседовать"],
  ["библиотека","библеотека"],
  ["библиотекарь","библеотекарь"],
  ["билет","белет"],
  ["богатство","багатсво"],
  ["ботинки","батинки"],

  ["вагон","вогон"],
  ["везде","везде"],
  ["велосипед","велосепед"],
  ["вокзал","вакзал"],
  ["впереди","впереди"],
  ["вчера","вчера"],
  ["газета","газета"],
  ["гореть","гареть"],
  ["горизонт","горизонт"],

  ["двадцать","20"],
  ["двенадцать","12"],
  ["директор","деректор"],

  ["ещё","ещё"],
  ["железо","жилезо"],
  ["завтра","зафтра"],

  ["здесь","сдесь"],

  ["издалека","издолека"],
  ["инженер","инженер"],

  ["календарь","календарь"],
  ["каникулы","каникулы"],
  ["кастрюля","кастрюля"],
  ["километр","киламетр"],
  ["командир","камандир"],
  ["комбайн","комбайн"],
  ["комбайнёр","комбайнёр"],
  ["корабль","карабль"],
  ["космонавт","касмонафт"],
  ["костёр","костёр"],
  ["косить","касить"],

  ["лучше","лутше"],

  ["медленно","медлено"],
  ["металл","метал"],

  ["назад","назад"],
  ["налево","налево"],
  ["направо","направо"],

  ["оборона","абарона"],
  ["одиннадцать","11"],

  ["пассажир","пасажир"],
  ["пассажирский","пасажирский"],
  ["пейзаж","пейзаж"],
  ["победа","пабеда"],
  ["пожалуйста","пажалуста"],
  ["портрет","портрет"],

  ["правительство","правитильство"],
  ["председатель","придседатиль"],
  ["прекрасный","прикрасный"],
  ["путешественник","путишествинник"],
  ["путешествие","путишевствие"],

  ["расстояние","растояние"],

  ["салют","салют"],
  ["сверкать","свиркать"],
  ["сверху","сверху"],
  ["свитер","свитор"],
  ["свобода","свабода"],
  ["сегодня","севодня"],
  ["сейчас","сейчаc"],
  ["семена","симина"],
  ["справа","справо"],
  ["слева","слево"],

  ["тарелка","тарелка"],
  ["телефон","телифон"],
  ["теперь","теперь"],
  ["тепловоз","теплавоз"],

  ["хлебороб","хлебароб"],
  ["хозяин","хазяин"],
  ["хозяйство","хазяйство"],

  ["человек","челавек"],

  ["шестнадцать","16"],
  ["шофёр","шофёр"],

  ["экскурсия","экскурссия"],
  ["электричество","электричиство"],
  ["электростанция","электростанция"]
];

let round = [];
let index = 0;
let answers = [];

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

// выбрать 17 случайных слов
function pickRandomWords() {
  const arr = WORDS.slice();
  shuffle(arr);
  return arr.slice(0, 17);
}

function startGame() {
  round = pickRandomWords();
  index = 0;
  answers = [];

  document.getElementById('results').style.display = "none";
  document.getElementById('restartBtn').style.display = "none";
  document.getElementById('game').style.display = "block";

  showWord();
}

function showWord() {
  const pair = round[index];
  document.getElementById('wrongWord').innerText = pair[1];
  document.getElementById('userInput').value = "";
  document.getElementById('userInput').focus();
  document.getElementById('progress').innerText =
    "Слово " + (index + 1) + " из " + round.length;
}

function nextWord() {
  const val = document.getElementById('userInput').value.trim();
  answers.push(val);
  index++;
  if (index < round.length) {
    showWord();
  } else {
    finish();
  }
}

// подсветка ошибок в введённом варианте
function diff(correct, user) {
  let out = "";
  const maxLen = Math.max(correct.length, user.length);
  for (let i = 0; i < maxLen; i++) {
    const c = correct[i] || "";
    const u = user[i] || "";
    if (!u) {
      out += '<span class="red">_</span>';
    } else if (c === u) {
      out += u;
    } else {
      out += '<span class="red">' + u + '</span>';
    }
  }
  return out;
}

function finish() {
  document.getElementById('game').style.display = "none";

  let errors = 0;
  let html = "<h3>Результаты</h3>";

  for (let i = 0; i < round.length; i++) {
    const correct = round[i][0];
    const user = answers[i] || "";
    if (correct !== user) errors++;

    html += '<div class="result-line">';
    html += "<b>" + correct + "</b> → " + diff(correct, user);
    html += "</div>";
  }

  let grade;
  if (errors === 0) grade = "5";
  else if (errors === 1) grade = "4";
  else if (errors === 2) grade = "4-";
  else if (errors === 3) grade = "3";
  else grade = "2";

  html += '<h2 class="red">Ваша оценка ' + grade + '</h2>';
  html += '<div class="small">Ошибок: ' + errors + '</div>';

  const res = document.getElementById('results');
  res.innerHTML = html;
  res.style.display = "block";
  document.getElementById('restartBtn').style.display = "block";
}

document.getElementById('okBtn').addEventListener('click', nextWord);
document.getElementById('userInput').addEventListener('keydown', function(e){
  if (e.key === 'Enter') nextWord();
});
document.getElementById('restartBtn').addEventListener('click', startGame);

startGame();
</script>

</body>
</html>
